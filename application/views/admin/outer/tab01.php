<?php 
require $_SERVER["DOCUMENT_ROOT"] . '/include/user/authAdm.php';
?>
<!DOCTYPE html> 
<!-- Generated by PHPExcel - http://www.phpexcel.net -->
<html>
  <head>
	<title>Proforma invoice</title>
  	  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	  <meta name="author" content="com" />
	  <meta name="company" content="Microsoft Corporation" />
	<link rel="stylesheet" type="text/css" media="screen" href="/lib/js/themes/redmond/jquery-ui.custom.css"></link>	
	<script src="/lib/jquery.jqGrid-4.6.0/js/jquery-1.11.0.min.js" type="text/javascript"></script>
	<script src="/lib/jquery-ui-1.11.0/jquery-ui.min.js" type="text/javascript"></script>
	<script src="/lib/js/jquery.form.js" type="text/javascript"></script>
	<script src="/js/cmn/common.js" type="text/javascript"></script>
	<script src="/lib/js/jquery.multiple.select.js"></script>
	<script src="/lib/js/msdropdown/jquery.dd.js"></script>
	<script src="/lib/js/jquery.ui.shake.js"></script>
	  
	<style type="text/css">
	  html { font-family:Calibri, Arial, Helvetica, sans-serif; font-size:11pt; background-color:white }
	  table { border-collapse:collapse; page-break-after:always }
	  .gridlines td { border:1px dotted black }
	  .b { text-align:center }
	  .e { text-align:center }
	  .f { text-align:right }
	  .inlineStr { text-align:left }
	  .n { text-align:right }
	  .s { text-align:left }
	  td.style0 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:11pt; background-color:white }
	  td.style1 { vertical-align:middle; text-align:justify; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style2 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:11pt; background-color:white }
	  td.style3 { vertical-align:bottom; text-align:center; border-bottom:4px solid #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:18pt; background-color:white }
	  td.style4 { vertical-align:bottom; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:11pt; background-color:white }
	  td.style5 { vertical-align:middle; text-align:justify; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#FF0000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style6 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#FF0000; font-family:'돋움'; font-size:11pt; background-color:white }
	  td.style7 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:11pt; background-color:white }
	  td.style8 { vertical-align:middle; text-align:justify; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:11pt; background-color:white }
	  td.style9 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:11pt; background-color:white }
	  td.style10 { vertical-align:top; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-style:italic; color:#000000; font-family:'Arial'; font-size:8pt; background-color:white }
	  td.style11 { vertical-align:middle; text-align:justify; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style12 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style13 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style14 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style15 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style16 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style17 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style18 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style19 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style20 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:9pt; background-color:white }
	  td.style21 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style22 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style23 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style24 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style25 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style26 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style27 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style28 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style29 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#FF0000; font-family:'돋움'; font-size:9pt; background-color:white }
	  td.style30 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style31 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style32 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style33 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style34 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:1px solid #000000 !important; border-right:1px solid #000000 !important; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style35 { vertical-align:middle; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style36 { vertical-align:middle; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style37 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style38 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:11pt; background-color:white }
	  td.style39 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style40 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style41 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style42 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style43 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style44 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style45 { vertical-align:middle; text-align:justify; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style46 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style47 { vertical-align:middle; text-align:left; padding-left:9px; border-bottom:none #000000; border-top:1px solid #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:12pt; background-color:white }
	  td.style48 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:12pt; background-color:white }
	  td.style49 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:12pt; background-color:white }
	  td.style50 { vertical-align:middle; text-align:left; padding-left:9px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style51 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style52 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:2px solid #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:11pt; background-color:white }
	  td.style53 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:11pt; background-color:white }
	  td.style54 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:9pt; background-color:white }
	  td.style55 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style56 { vertical-align:middle; text-align:center; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:10pt; background-color:white }
	  td.style57 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:10pt; background-color:white }
	  td.style58 { vertical-align:middle; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'돋움'; font-size:10pt; background-color:white }
	  td.style59 { vertical-align:middle; text-align:justify; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:12pt; background-color:white }
	  td.style60 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#FF0000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style61 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style62 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style63 { vertical-align:middle; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style64 { vertical-align:top; text-align:right; padding-right:0px; border-bottom:none #000000; border-top:none #000000; border-left:none #000000; border-right:none #000000; font-style:italic; color:#000000; font-family:'Arial'; font-size:8pt; background-color:white }
	  td.style65 { vertical-align:middle; text-align:left; padding-left:0px; border-bottom:1px solid #000000 !important; border-top:none #000000; border-left:none #000000; border-right:none #000000; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style66 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style67 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:1px solid #000000 !important; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style68 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:none #000000; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  td.style69 { vertical-align:middle; text-align:center; border-bottom:1px solid #000000 !important; border-top:1px solid #000000 !important; border-left:none #000000; border-right:1px solid #000000 !important; font-weight:bold; color:#000000; font-family:'Arial'; font-size:10pt; background-color:white }
	  table.sheet0 col.col0 { width:42.02222174pt }
	  table.sheet0 col.col1 { width:16.26666648pt }
	  table.sheet0 col.col2 { width:12.87777763pt }
	  table.sheet0 col.col3 { width:104.37777658pt }
	  table.sheet0 col.col4 { width:39.31111066pt }
	  table.sheet0 col.col5 { width:58.28888822pt }
	  table.sheet0 col.col6 { width:58.28888822pt }
	  table.sheet0 col.col7 { width:42.02222174pt }
	  table.sheet0 tr { height:15pt }
	</style>
  </head>

  <body>
<style>
@page { left-margin: 0.98425196850394in; right-margin: 0.98425196850394in; top-margin: 0.19685039370079in; bottom-margin: 0.039370078740157in; }
body { left-margin: 0.98425196850394in; right-margin: 0.98425196850394in; top-margin: 0.19685039370079in; bottom-margin: 0.039370078740157in; }
</style>

<div id="resultDiv" style="display:none">
	<div id="resultBtnDiv" style="display:">
	<table border="0" cellpadding="0" cellspacing="0" style="width: 210mm; display:" align=center>
	<tr>
		<td colspan=10 align=right>
		<input type="button" id="btnEdit" name="btnEdit" value="edit" onclick="javascript:fn_edit();"/>
		<input type="button" id="btnExcel" name="btnExcel" value="Excel" onclick="javascript:fn_excelDown();"/>
		<input type="button" id="btnMail" name="btnMail" value="send mail" onclick="javascript:fn_sendMail();"/>
		</td>
	</tr>
	</table>
	</div>
</div>
<div id="saveFormDiv">	
<form id="saveForm" name="saveForm" method="post">
<input type=hidden id="pi_no" name="pi_no">
<input type=hidden id="edit_mode" name="edit_mode">
	<table border="0" cellpadding="0" cellspacing="0" id="sheet0" style="width: 210mm;" align=center>
	<tr>
		<td colspan=10 align=right>
		<input type="button" id="btnSave" name="btnSave" value="save" onclick="javascript:fn_save();"/>
		<input type="button" id="btnSend" name="btnSend" value="send" onclick="javascript:fn_readMail();" disabled/>
		</td>
	  </tr>
	</table>
	<p><div id="error">

	<table border="0" cellpadding="0" cellspacing="0" id="sheet0" class="sheet0" style="width: 210mm;height: 290mm;" align=center>
		<col class="col0">
		<col class="col1">
		<col class="col2">
		<col class="col3">
		<col class="col4">
		<col class="col5">
		<col class="col6">
		<col class="col7">
		<tbody>
<!-- 		
		  <tr class="row0">
			<td class="column0 style1 null"></td>
			<td class="column1 style1 null"></td>
			<td class="column2 style1 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4" colspan=3>
		  		<table border=0>
				  <tr>
					<td width=5% rowspan="2" class="style12">결<br/>재</td>
					<td colspan="2" width=70px class="style12">담당</td>
					<td colspan="2" width=70px class="style12">팀장</td>
					<td colspan="2" width=70px class="style12">이사</td>
					<td colspan="2" width=80px class="style12">대표이사</td>
				  </tr>
				  <tr height=70px>
				  	<td colspan="2" height=70px class="style12"></td>
					<td colspan="2" class="style12"></td>
					<td colspan="2" class="style12"></td>
					<td colspan="2" class="style12"></td>
				  </tr>
		  		</table>
			</td>
		  </tr>
 -->		  
		  <tr class="row4">
			<td class="column0 style3 s" colspan=7>PROFORMA INVOICE</td>
		  </tr>
		  <tr class="row5">
			<td class="column0 style1 s">&nbsp;</td>
			<td class="column1 style1 null"></td>
			<td class="column2 style1 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row6">
			<td class="column0 style62 n style62" colspan="3">Date: <input type=text id="txt_invoice_dt" name="txt_invoice_dt" value="" size=12 style="border-style: none;background-color: white;" disabled></td>
			<td class="column3 style5 null"></td>
			<td class="column4">&nbsp;</td>
			<td class="column5 style63 n style63" colspan="2"><div id="txt_pi_no"></div></td>
		  </tr>
		  <tr class="row7">
			<td class="column0 style7 s">Messrs.</td>
			<td class="column1 style7 s" colspan=4>: <input type=text id="csn_cmpy_nm" name="csn_cmpy_nm" value="" size=50 style="border-style: none;background-color: white;" disabled></td>
			<td class="column5 style64 null style64" colspan="2"></td>
		  </tr>
		  <tr class="row8">
			<td class="column0 style8 s">Attn.</td>
			<td class="column1 style9 s" colspan=5>: <input type=text id="csn_attn" name="csn_attn" value="" size=12 style="border-style: none;background-color: white;" disabled></td>
			<td class="column6 style10 null"></td>
		  </tr>
		  <tr class="row9">
			<td class="column0 style11 null"></td>
			<td class="column1 style11 null"></td>
			<td class="column2 style11 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5 style10 null"></td>
			<td class="column6 style10 null"></td>
		  </tr>
		  
		  <tr class="row10">
			<td class="column0 style65 s style65" colspan="7">We are pleased to confirm your order for the under-mentioned article(s) as per conditions and details described as follows:</td>
		  </tr>
		  <tr class="row11">
		  	<td class="column0 style12 s" style="border-left:1px solid #000000">Model</td>
			<td class="column1 style66 s style66" colspan="3">Description</td>
			<td class="column4 style12 s">Q’ty</td>
			<td class="column5 style13 s">Unit Price</td>
			<td class="column6 style13 s">Amount</td>
		  </tr>
		  <tr class="row18">
			<td class="column0 style25 null"></td>
			<td class="column1 style26 s" colspan="3"><div id="eqpDiv" style="display:none;padding-left: 10px;">Currency Discrimination Counter</div></td>
			<td class="column4 style28 null"></td>
			<td class="column5 style18 null"></td>
			<td class="column6 style18 null"></td>
		  </tr>
		  <tr class="row12" id="eqpListDiv" style="display:none">
			<td class="column0 style14 s"><div id="mdl_nm" style="line-height:55px;"></div></td>
			<td class="column1 style15 s" colspan="3"><div id="dscrt" style="padding-left: 10px;line-height:20px;"></div>
			</td>
			<td class="column4 style17 n"><div id="eqp_qty" style="line-height:50px;"></div></td>
			<td class="column5 style18 n"><div id="eqp_unit_price" style="line-height:50px;"></div></td>
			<td class="column6 style19 f"><div id="eqp_amt" style="line-height:50px;"></div></td>
		  </tr>
		  <tr class="row18">
			<td class="column0 style25 null"></td>
			<td class="column1 style26 s" colspan="3"><div id="partsDiv" style="padding-left: 10px;"></div></td>
			<td class="column4 style28 null"></td>
			<td class="column5 style18 null"></td>
			<td class="column6 style18 null"></td>
		  </tr>
		  <tr class="row19">
			<td class="column0 style25 null"></td>
			<td class="column1 style30 s" colspan="3"><div id="spare_parts" style="padding-left: 10px;"></div></td>
			<td class="column4 style28 n"><div id="qty" name="qty"></div></td>
			<td class="column5 style18 n"><div id="unit_price" name="unit_price"></div></td>
			<td class="column6 style19 f"><div id="amount" name="amount"></div></td>
		  </tr>
		  <tr class="row22" id="eqpHwOptDiv" style="display:none">
			<td class="column0 style14 null">HW Option</td>
			<td class="column1 style30 s" colspan=3><div id="txt_opt_hw_atcd" style="padding-left: 10px;line-height:50px;"></div></td>
			<td class="column4 style33 null"><div id="opt_qty" style="line-height:50px;"></div></td>
			<td class="column5 style19 null"><div id="opt_unit_prc" style="line-height:50px;"></div></td>
			<td class="column6 style34 null"><div id="opt_amt" style="line-height:50px;"></div></td>
		  </tr>
		  <tr class="row18">
			<td class="column0 style25 null"></td>
			<td class="column1 style26 s" colspan="3"></td>
			<td class="column4 style28 null"></td>
			<td class="column5 style18 null"></td>
			<td class="column6 style18 null"></td>
		  </tr>
		  <tr class="row19" id="repairDiv" style="display:none">
			<td class="column0 style25 null"></td>
			<td class="column1 style26 s" colspan="3"><div style="padding-left: 10px;">Repair Parts</div></td>
			<td class="column4 style28 n"><div id="repr_qty"></div></td>
			<td class="column5 style18 n"></td>
			<td class="column6 style19 f"><div id="repr_tot_amt"></div></td>
		  </tr>
		  <tr class="row18">
			<td class="column0 style25 null"></td>
			<td class="column1 style26 s" colspan="3"></td>
			<td class="column4 style28 null"></td>
			<td class="column5 style18 null"></td>
			<td class="column6 style18 null"></td>
		  </tr>
		  <tr class="row12" id="frtChrgDiv" style="display:none">
			<td class="column0 style14 s"></td>
			<td class="column1 style26 s" colspan="3"><div style="padding-left: 10px;">Freight Charge</div>
			</td>
			<td class="column4 style17 n"></td>
			<td class="column5 style18 n"></td>
			<td class="column6 style19 f"><div id="frtchrg_amt"></td>
		  </tr>
		  <tr class="row18">
			<td class="column0 style25 null"></td>
			<td class="column1 style26 s" colspan="3"></td>
			<td class="column4 style28 null"></td>
			<td class="column5 style18 null"></td>
			<td class="column6 style18 null"></td>
		  </tr>
		  <tr class="row26">
			<td class="column0 style67 s style27" colspan="4">Total Amount</td>
			<td class="column4 style36 null"></td>
			<td class="column5 style36 null"></td>
			<td class="column6 style37 f"><div id="tot_amt" name="tot_amt"></div></td>
		  </tr>
		  <tr class="row16">
			<td class="column0 style14 s">Addon
			<select id="addon" name="addon" onchange="javascript:fn_verifyAddon(this.value);">
				<option value="">select</option>
				<option value="FRT">Freight Charge</option>
				<option value="RPR">Repair Parts</option>
			</select>
			</td>
			<td class="column1 style24 s" colspan="3"><!-- <input type=text name="description" value="SP-58S" size=8 disabled> --></td>
			<td class="column4 style17 n"><input type=text id="addon_qty" name="addon_qty" value="" size=8 maxlength=6 style="ime-mode:disabled" onKeyup="fncOnlyDecimal(this);" disabled></td>
			<td class="column5 style19 n"></td>
			<td class="column6 style19 f"><input type=text id="addon_tot_amt" name="addon_tot_amt" value="" size=8 maxlength=8 style="ime-mode:disabled" onKeyup="fncOnlyDecimal(this);" disabled></td>
		  </tr>
		  <tr class="row25">
			<td class="column0 style36 style14 s">Remark</td>
			<td class="column1 style36 s" colspan="5"><textarea id="pi_rmk" name="pi_rmk" cols=60 rows=7 maxlength=1000></textarea></td>
			<td class="column6 style37 f"></td>
		  </tr>
		  <tr class="row27">
			<td class="column0 style11 null"></td>
			<td class="column1 style11 null"></td>
			<td class="column2 style11 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6 style38 null"></td>
		  </tr>
		  <tr class="row28">
			<td class="column0 style39 s" colspan=2>Origin</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style39 s" colspan=4>Republic of Korea</td>
		  </tr>
		  <tr class="row29">
			<td class="column0 style39 s" colspan=2>Packing</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style39 s" colspan=4>Export standard carton packing</td>
		  </tr>
		  <tr class="row30">
			<td class="column0 style39 s" colspan=2>Shipment</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style61 s style61" colspan="3">To be announced</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row31">
			<td class="column0 style39 s" colspan=2>Shipping port</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style39 s" colspan=4>
			<select id="ship_port_atcd" name="ship_port_atcd">
			</select>
			</td>
		  </tr>
		  <tr class="row32">
			<td class="column0 style39 s" colspan=2>Inspection</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style39 s" colspan=4>Final inspection shall be made at the SBM’s factory</td>
		  </tr>
		  <tr class="row33">
			<td class="column0 style39 s" colspan=2>Destination</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style39 s" colspan=4><input type=text id="destnt" name="destnt" value="" size=8>, <input type=text id="cntry" name="cntry" value="" size=50 style="border-style: none;background-color: white;" disabled></td>
		  </tr>
		  <tr class="row34">
			<td class="column0 style39 s" colspan=2>Payment</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style39 s" colspan=4>
			<select id="payment_atcd" name="payment_atcd">
			</select>
			 (All expenses outside of Korea shall be charged by remitter)
			</td>
		  </tr>
		  <tr class="row35">
			<td class="column0 style39 s" colspan=2>Validity</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style42 f">Until <INPUT type=text id="validity" name="validity" value="Apr. 18, 2014" size=10 maxlength=0></td>
			<td class="column4 style43 null"></td>
			<td class="column5 style43 null"></td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row36">
			<td class="column0 style44 s" colspan=2>Bank Information</td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style60 s" colspan=4>
				<select id="bank_atcd" name="bank_atcd">
				</select>
			</td>
		  </tr>
		  <tr class="row40">
			<td class="column0 style1 s">Reference:</td>
			<td class="column1 style45 null"></td>
			<td class="column2 style40 s">:</td>
			<td class="column3 style41 s" colspan=4>If you delay the incoterms date already agreed with us </td>
		  </tr>
		  <tr class="row41">
			<td class="column0 style1 null"></td>
			<td class="column1 style59 null"></td>
			<td class="column2 style59 null"></td>
			<td class="column3 style41 s" colspan=4>we duly inform that the new date is subject to our production schedule.</td>
		  </tr>
		  <tr class="row42">
			<td class="column0 style45 null"></td>
			<td class="column1 style45 null"></td>
			<td class="column2 style45 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row43">
			<td class="column0 style45 null"></td>
			<td class="column1 style45 null"></td>
			<td class="column2 style45 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row44">
			<td class="column0 style45 null"></td>
			<td class="column1 style45 null"></td>
			<td class="column2 style45 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row45">
			<td class="column0 style45 null"></td>
			<td class="column1 style45 null"></td>
			<td class="column2 style45 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row46">
			<td class="column0 style45 null"></td>
			<td class="column1 style45 null"></td>
			<td class="column2 style45 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row47">
			<td class="column0 style45 null"></td>
			<td class="column1 style45 null"></td>
			<td class="column2 style45 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row48">
			<td class="column0 style46 null"></td>
			<td class="column1 style46 null"></td>
			<td class="column2 style46 null"></td>
			<td class="column3">&nbsp;</td>
			<td class="column4">&nbsp;</td>
			<td class="column5">&nbsp;</td>
			<td class="column6">&nbsp;</td>
		  </tr>
		  <tr class="row49">
			<td class="column0 style47 s" colspan=5><div id="worker_eng_nm"></div></td>
			<td class="column5 style2 null"></td>
			<td class="column6 style2 null"></td>
		  </tr>
		  <tr class="row50">
			<td class="column0 style50 s" colspan=7><div id="worker_team_duty"></div></td>
		  </tr>
		  <tr class="row51">
			<td class="column0 style52 s" colspan=7>SBM Co., Ltd.</td>
		  </tr>
		  <tr class="row52">
			<td class="column0 style54 s" colspan=7>6F, Hyunwoo Bld, 206, Anyang7-Dong, Manan-Gu, Anyang-City, Gyeonggi-Do, KOREA . 430-817</td>
		  </tr>
		  <tr class="row53">
			<td class="column0 style54 s" colspan=7></td>
		  </tr>
		  <tr class="row54">
			<td class="column0 style55 s" colspan=3>SBM-<span style="color:#000000; font-family:'돋움'; font-size:10pt">영업</span><span style="color:#000000; font-family:'Arial'; font-size:10pt">-P-701-02</span></td>
			<td class="column3 style57 s">㈜에스비엠</td>
			<td class="column4 style56 null"></td>
			<td class="column5 style56 null"></td>
			<td class="column6 style57 s">A4(210 X297mm)</td>
		  </tr>
		</tbody>
	</table>
	
</form>
</div>

</body>
  
<script type="text/javascript">

	$(document).ready(function(e) {	
<?php
if(isset($_REQUEST["edit_mode"])){
	$edit_mode = $_REQUEST["edit_mode"];
?> 
		$("#edit_mode").val("<?php echo $edit_mode;?>");
	
		var params = {
			"pi_no": "<?php echo $_REQUEST["pi_no"];?>"
		};  
		$.ajax({
	        type: "POST",
	        url: "/index.php/admin/outer/viewInvoice",
	        async: false,
	        dataType: "json",
	        data: params,
	        cache: false,
	        success: function(result, status, xhr){
	//			            alert(xhr.status);
				$("#pi_no").val(params.pi_no);
				if($("#edit_mode").val()=="1"){
					editForm(result);
				}else if($("#edit_mode").val()=="0" || $("#edit_mode").val()=="2"){
					fn_readMail();
					if($("#edit_mode").val()=="0"){
						resultBtnDiv.style.display = "none";
					}
				}
			}
		});
				
<?php 
}
?>

	});

	$.datepicker.setDefaults($.datepicker.regional['ko']);

	$(function() {
	    $( "#validity" ).datepicker({
	        constrainInput: true,
//	        showOn: 'both',
//	        buttonImageOnly: 'true',
//	        buttonImage: '/img/calendarBtn.png',
	        showMonthAfterYear: true,
	        dateFormat: 'yy-mm-dd',
	        changeMonth: true,
	        changeYear: true,
	        beforeShow: function(input,inst){inst.dpDiv.css({ 'top': input.offsetHeight+ 'px', 'left': (input.offsetWidth - input.width)+ 'px'});},
	        onSelect: function(dateText, inst) {
	            checkDate(dateText,'from');
	        }
	    });
	});

	function checkDate(dateText, inst){
	    var today = "<?php echo date("Y-m-d")?>";
	    if (inst=="from") {
	        if (dateText < today) {
	            alert("select validity date after today.");
	            $("#validity").val("");
	        }
	    }
	}

	function editForm(result) {
    	var invoiceInfo = result.invoiceInfo; 
    	var orderEqpList = result.orderEqpList; 
    	var orderPartList = result.orderPartList; 
    	var eqpHwOptList = result.eqpHwOptList; 

		var f = document.saveForm;
		getCodeCombo("00F3", f.ship_port_atcd, invoiceInfo.ship_port_atcd);
		if(orderEqpList==null){
			getCodeCombo("00G0", f.payment_atcd, invoiceInfo.payment_atcd);
		}else{
			getOrderPaymentCombo(invoiceInfo.pi_no, f.payment_atcd, invoiceInfo.payment_atcd);
		}
		getCodeCombo("0050", f.bank_atcd, invoiceInfo.bank_atcd);

		$("#csn_cmpy_nm").val(invoiceInfo.csn_cmpy_nm);
		$("#csn_attn").val(invoiceInfo.csn_attn);
		$("#txt_invoice_dt").val(invoiceInfo.txt_invoice_dt);
		$("#destnt").val(invoiceInfo.destnt);
		$("#cntry").val(invoiceInfo.cntry);
		$("#validity").val(invoiceInfo.validity_dt);
		$("#pi_rmk").val(invoiceInfo.pi_rmk);

		$("#txt_pi_no").html("Our Ref: PI-" + invoiceInfo.pi_no);
		if(invoiceInfo.pi_sndmail_seq!=null){
			$("#txt_pi_no").append("-" + invoiceInfo.pi_sndmail_seq);
		}
		$("#worker_eng_nm").html(invoiceInfo.worker_eng_nm);
		$("#worker_team_duty").html(invoiceInfo.worker_team_duty);

		var mdl_nm = "";
		var eqp_qty = "";
		var eqp_unit_price = "";
		var eqp_amt = "";
		var detector = "";
		var incoterms = "";
		var dscrt = "";
		var shipped_by = "";
		var courier = "";
		var amt = "0";
		if(orderEqpList!=null){
			eqpDiv.style.display = "";
			eqpListDiv.style.display = "";
			$.each(orderEqpList, function(key) {
				var targetInfo = orderEqpList[key];
				mdl_nm += targetInfo.mdl_nm + "<br>";
				eqp_qty += targetInfo.eqp_qty + "<br>";
				if(targetInfo.amt!=null){
					amt = targetInfo.amt;
				}
				eqp_unit_price += "<input type=text id='eqp_unit_price' name='eqp_unit_price[]' value='' size=8 maxlength=8 style='ime-mode:disabled' onKeyup='fncOnlyDecimal(this);fn_calcAmt(this.value, " + targetInfo.eqp_qty + ", " + key + ");'>";
				eqp_amt += "<input type=text id='amt' name='amt[]' value='" + amt + "' size=8 maxlength=8 style='ime-mode:disabled' readOnly>";
				eqp_amt += "<input type=hidden id='po_no' name='po_no[]' value='" + targetInfo.po_no + "'>";
				detector = "";
				incoterms = "";
				shipped_by = "";
				courier = "";
				var serial = "";
				if(targetInfo.txt_srl_atcd!=null){
					serial = " only " + targetInfo.txt_srl_atcd + " for " + targetInfo.serial_currency;
				}
				if(targetInfo.txt_incoterms_atcd!=null){
					incoterms += " , " + "Incoterms:" + targetInfo.txt_incoterms_atcd;
				}
				if(targetInfo.txt_shipped_by_atcd!=null){
					shipped_by += "shipped_by " + targetInfo.txt_shipped_by_atcd;
				}
				if(targetInfo.txt_courier_atcd!=null){
					courier += "(" + targetInfo.txt_courier_atcd + ")";
				}
				dscrt += "P/O NO:" + targetInfo.po_no;
				dscrt += incoterms + "<BR>";
				dscrt += shipped_by;
				dscrt += courier + "<BR>";
				if(targetInfo.detector!=""){
					dscrt += "Counterfeit Detection:" + targetInfo.detector + "<BR>";
				}
				dscrt += "For " + targetInfo.currency + serial + "<p>";
			})
	        $("#mdl_nm").html(mdl_nm);
	        $("#dscrt").html(dscrt);
	        $("#eqp_qty").html(eqp_qty);
	        $("#eqp_unit_price").html(eqp_unit_price);
	        $("#eqp_amt").html(eqp_amt);
		}
		
		var spare_parts = "";
		var qty = "";
		var unit_price = "";
		var amount = "";
		if(orderPartList!=null){
			$.each(orderPartList, function(key) {
				var targetInfo = orderPartList[key];
				spare_parts += targetInfo.mdl_nm + " " + targetInfo.part_nm + "<p>";
				qty += targetInfo.qty + "<p>";
				unit_price += "USD " + targetInfo.unit_price + "<p>";
				amount += "USD " + fnc_commify(targetInfo.amount) + "<p>";
	        })
	        $("#partsDiv").html("spare_parts");
	        $("#spare_parts").html(spare_parts);
	        $("#qty").html(qty);
	        $("#unit_price").html(unit_price);
	        $("#amount").html(amount);
	        
		}
		
		if(invoiceInfo.repr_qty!=null){
			repairDiv.style.display = "";
	        $("#repr_qty").html(invoiceInfo.repr_qty);
	        $("#repr_tot_amt").html("USD " + fnc_commify(invoiceInfo.repr_tot_amt));
		}
		
		if(invoiceInfo.frtchrg_amt!=null){
			frtChrgDiv.style.display = "";
	        $("#frtchrg_amt").html("USD " + fnc_commify(invoiceInfo.frtchrg_amt));
		}

		if(eqpHwOptList!=null){
			eqpHwOptDiv.style.display = "";
			var opt_mdl_nm = "";
			var txt_opt_hw_atcd = "";
			var opt_unit_prc = "";
			var opt_qty = "";
			var opt_amt = "";
			$.each(eqpHwOptList, function(key) {
				var targetInfo = eqpHwOptList[key];
				txt_opt_hw_atcd += targetInfo.txt_opt_hw_atcd + " ( " + targetInfo.opt_mdl_nm + " )<br>";
				opt_qty += "<input type=text id='opt_qty' name='opt_qty[]' value='" + targetInfo.opt_qty + "' size=8 maxlength=8 style='ime-mode:disabled' onKeyup='fncOnlyDecimal(this);fn_calcOptAmt(" + key + ");'>" + "<br>";
				opt_unit_prc += "<input type=text id='opt_unit_prc' name='opt_unit_prc[]' value='" + targetInfo.opt_unit_prc + "' size=8 maxlength=8 style='ime-mode:disabled' onKeyup='fncOnlyDecimal(this);fn_calcOptAmt(" + key + ");'>" + "<br>";
				opt_amt += "<input type=text id='opt_amt' name='opt_amt[]' value='" + targetInfo.opt_amt + "' size=8 maxlength=8 style='ime-mode:disabled' disabled>" + "<br>";
				opt_amt += "<input type=hidden id='opt_atcd' name='opt_atcd[]' value='" + targetInfo.atcd + "'>";
				opt_amt += "<input type=hidden id='opt_po_no' name='opt_po_no[]' value='" + targetInfo.po_no + "'>";
			})
	        $("#txt_opt_hw_atcd").html(txt_opt_hw_atcd);
	        $("#opt_unit_prc").html(opt_unit_prc);
	        $("#opt_qty").html(opt_qty);
	        $("#opt_amt").html(opt_amt);
		}
				
				
        $("#tot_amt").html("USD " + fnc_commify(invoiceInfo.inv_tot_amt));
		if(orderEqpList!=null){
			if(invoiceInfo.discount > 0){
				$("#tot_amt").append("<br>(Eqp.DC:-" + fnc_commify(invoiceInfo.discount) + ")");
			}
		}
		if(invoiceInfo.wrk_tp_atcd<"00700410"){  // INVOICE 발송(00700410)
			$('#btnSave').attr('disabled',false);
			$('#btnSend').attr('disabled',false);
		}else{
			$('#btnSave').attr('disabled',true);
			$('#btnSend').attr('disabled',true);
		}
		
	}

	function fn_verifyAddon(value){
		if(value!=""){
			$("#addon_qty").val('');
			$("#addon_tot_amt").val('');
			if(value=="RPR"){
				$("#addon_qty").attr('disabled',false);
			}else{
				$("#addon_qty").attr('disabled',true);
			}
			$("#addon_tot_amt").attr('disabled',false);
		}else{
			$("#addon_qty").val('');
			$("#addon_tot_amt").val('');
			$("#addon_qty").attr('disabled',true);
			$("#addon_tot_amt").attr('disabled',true);
		}
	}

	function fn_isValid(){
		if($("#addon").val()!=""){
			if($("#addon").val()!="FRT" && $("#addon_qty").val()==""){
				alert("qty is required!");
				$("#addon_qty").focus();
				return false;
			}
			if($("#addon_tot_amt").val()==""){
				alert("tot_amt is required!");
				$("#addon_tot_amt").focus();
				return false;
			}
			/**
			if($("#payment_atcd").val()==""){
				alert("payment is required!");
				$("#payment_atcd").focus();
				return false;
			}
			*/
		}
		return true;
	}

	function fn_calcAmt(unit_price, qty, key){
		var f = document.saveForm;
		var amt = unit_price * qty;
		if(f.amt.length){
	    	f.amt[key].value = amt;
		}else{
	    	f.amt.value = amt;
		}
	}

	function fn_calcOptAmt(key){
		var f = document.saveForm;
		if(f.opt_qty.length){
	    	f.opt_amt[key].value = f.opt_qty[key].value * f.opt_unit_prc[key].value;
		}else{
	    	f.opt_amt.value = f.opt_qty.value * f.opt_unit_prc.value;
		}
	}

	function fn_edit(){
    	location.replace("/index.php/admin/outer/tab01?edit_mode=1&pi_no=" + $("#pi_no").val());
	}

	function fn_readMail(){
		var params = {"sndmail_atcd":"00700211", "pi_no":$("#pi_no").val()};  
	
		saveFormDiv.style.display = "none";
		fncReadMail(params);
		resultDiv.style.display = "";
		
	}

	function fn_excelDown(){
		var params = {"sndmail_atcd":"00700211", "pi_no":$("#pi_no").val()};  
		location.href="/index.php/common/main/htmlToExcel?pi_no=" + $("#pi_no").val() + "&sndmail_atcd=00700211";
	}

	function fn_sendMail(){
		if(confirm("딜러에게 메일이 발송됩니다. 계속하시겠습니까?")){
			var params = {"wrk_tp_atcd": "00700210","sndmail_atcd":"00700211", "pi_no":$("#pi_no").val()};  
			fncCrtPiSndMail(params);
		}else{
			return;
		}
	}

	
	function fn_save() {
		var f = document.saveForm;
		
		if(!fn_isValid()){
			return;
		}
		f.action = "/index.php/admin/outer/saveInvoice";

//		$('#btnSave').attr('disabled',true);
		$('#btnSend').attr('disabled',true);

//		f.submit();
//		return;
		var options = {
					type:"POST",
					dataType:"json",
			        beforeSubmit: function(formData, jqForm, options) {
//			        	$("#resultDiv").html('<b>this order is sending...</b>');
					},
			        success: function(result, statusText, xhr, $form) {
			            if(statusText == 'success'){
				            var todo = result.qryInfo.todo;	  
				            if(todo == "Y"){
					            var qryInfo = result.qryInfo;	            	
			    				if(qryInfo.result2==false)
			    		        {
			    					$("#error").html("<span style='color:#cc0000'>Error:</span> Sql Error!. " + qryInfo.sql2);
			            			return;
			    				}else{
//			    		        	alert(qryInfo.result2 + ":" + qryInfo.sql2);
			    				}
			    				if(qryInfo.result3==false)
			    		        {
			    					$("#error").html("<span style='color:#cc0000'>Error:</span> Sql Error!. " + qryInfo.sql3);
			    		        	return;
			    				}else{
//			    		        	alert(qryInfo.result3 + ":" + qryInfo.sql3);
			    				}
			    				if(qryInfo.result4==false)
			    		        {
			    					$("#error").html("<span style='color:#cc0000'>Error:</span> Sql Error!. " + qryInfo.sql4);
			    		        	return;
			    				}else{
//			    		        	alert(qryInfo.result4 + ":" + qryInfo.sql4);
			    				}
				            }else if(todo == "N"){
					            var txt_wrk_tp_atcd = result.qryInfo.txt_wrk_tp_atcd;
					            if(cnfm_yn == "Y"){
						            alert("This PI is already confirmed!(" + txt_wrk_tp_atcd + ")");
						            return;
					            }	  
							}          	
					    	$('#btnSave').attr('disabled',false);
					    	alert("success!");
					    	fn_edit();
			            }
					},
			        /* ajax options omitted */
			        error:function(){
			        	$('#error').shake();
						$("#error").html("<span style='color:#cc0000'>Error:</span> Sql Error!. ");
					}
					
			    };
		$("#saveForm").ajaxSubmit(options);
	}
	
</script>

</html>